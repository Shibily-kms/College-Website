{{!-- active button --}}
<script>
    var current = document.getElementById('Updates').className = "main-item active-main"
</script>

{{!-- --}}
<section id="admin-container" class="admin-container">
    <div class="headding">
        <div>
            <i class="bi bi-file-person-fill"></i>
            <h4>Status frame</h4>
        </div>
    </div>
    <div class="add-button-top">
        <button type="button" onclick="openmodelFrame('new');" class="btn-lg"><i class="bi bi-plus-circle-dotted"></i>
            Add frame</button>
    </div>
    <div class="edit-profile frame-edit">

        {{#each AllFrames}}
        <div id="profileDiv{{this.Id}}" class="profile ">
            <img src="/images/frames/{{this.Id}}-1.jpg" alt="Frame">
            <h5 id="header{{this.Id}}">{{this.Header}} </h5>

            <p id="IX{{this.Id}}" hidden>{{this.IX}}</p>
            <p id="IY{{this.Id}}" hidden>{{this.IY}}</p>
            <p id="IW{{this.Id}}" hidden>{{this.IW}}</p>
            <p id="IH{{this.Id}}" hidden>{{this.IH}}</p>
            <p id="NX{{this.Id}}" hidden>{{this.NX}}</p>
            <p id="NY{{this.Id}}" hidden>{{this.NY}}</p>
            <p id="NW{{this.Id}}" hidden>{{this.NW}}</p>
            <p id="NH{{this.Id}}" hidden>{{this.NH}}</p>
            <p id="Hide{{this.Id}}" hidden>{{this.Hide}}</p>

            <div class="profile-overly " style="height:150px ; top: 50px;">

                <div class="" style="margin-left: 3px; margin-right: 3px;" title="Count">
                    <i class="bi bi-download"></i> {{this.Count}}
                </div>
                <div class="" style="margin-left: 3px; margin-right: 3px;" title="View & Edit"
                    onclick="openmodelFrame('{{this.Id}}')">
                    <i class="bi bi-arrows-fullscreen"></i>
                </div>
                <div class="" style="margin-left: 3px; margin-right: 3px;" onclick="hideFrame('{{this.Id}}')">

                    <i {{#if this.Hide}} title="Show to user" {{else}} title="Hide from user" {{/if}}
                        id="hideIcon{{this.Id}}" {{#if this.Hide}} class="bi bi-eye" {{else}} class="bi bi-eye-slash"
                        {{/if}}></i>



                </div>
                <div title="Remove" style="margin-left: 3px; margin-right: 3px;" onclick="deleteFrame('{{this.Id}}')"
                    class="remove">
                    <i id="removeIcon{{this.Id}}" class="bi bi-trash3"></i>
                </div>
            </div>

            <div class="profile-overly frame-overly" style="top:60px; box-shadow:none; ">

                <a href="/status-frame/{{this.Id}}" target="_blank">
                    <div class="" style="margin-left: 3px; margin-right: 3px;" title="Count">
                        <i class="bi bi-box-arrow-up-left"></i> Check
                    </div>
                </a>
                <input id="copy-text{{this.Id}}" value="https://www.nsaonline.in/status-frame/{{this.Id}}" hidden>
                <div class="" style="margin-left: 3px; margin-right: 3px;" title="View & Edit"
                    onclick="copyLinkFrame('{{this.Id}}')" id="copy-btn-div{{this.Id}}">
                    <i id="copy-btn-icon{{this.Id}}" class="bi bi-clipboard"></i> Link
                </div>

            </div>

        </div>
        {{/each}}
    </div>
    <div class="model-border frame-edit-model" id="profile-Div">
        <div class="edit-slider teacher-profile-div" id="profile-model">
            <div class="model admin-frame">
                <div class="header">
                    <h4 id="model-header">Update frame</h4>
                    <i title="Close" class="bi bi-x-circle" onclick="closeModel('profile-Div')"></i>
                </div>
                <div class="content ">
                    <form action="/admin/frame" method="post" enctype="multipart/form-data">
                        <div class="image">
                            <div class="">
                                <h5>Poster thumb</h5>
                                <img id="profile-image" src="/images/background/1.jpg" alt="profile">

                                <div data-title="Choose image" class="admin-edit">
                                    <i onclick="chooseImage1()" class="bi bi-camera-fill"></i>
                                </div>
                                <input type="file" onchange="viewImage(event)" hidden
                                    accept="image/jpg, image/png, image/jpeg" name="FramePoster" id="frame-file1">

                            </div>
                            <div style="margin-top: 10px;" class="">
                                <h5>Status thumb</h5>
                                <img id="profile-image2" src="/images/background/1.jpg" alt="profile">

                                <div data-title="Choose image" class="admin-edit">
                                    <i onclick="chooseImage2()" class="bi bi-camera-fill"></i>
                                </div>
                                <input type="file" onchange="viewImage2(event)" hidden
                                    accept="image/jpg, image/png, image/jpeg" name="Frame" id="frame-file2">

                            </div>
                        </div>
                        <input type="text" id="slider-id" hidden name="Id">
                        <input type="text" id="" hidden name="Hide">
                        <div class="on-content">
                            <div class="header-input">
                                <label for="">Header</label>
                                <input class="text-input" type="text" name="Header" value="" id="header">
                            </div>
                            <h5>User Photo Detials</h5>
                            <div class="axis-inputs">
                                <div class="col">
                                    <label for="">X axis</label>
                                    <input class="text-input" type="number" name="IX" id="IX" value=""
                                        placeholder="Pixel size" required>
                                </div>
                                <div class="col">
                                    <label for="">Y axis</label>
                                    <input class="text-input" type="number" name="IY" id="IY" value=""
                                        placeholder="Pixel size" required>
                                </div>
                            </div>
                            <div class="axis-inputs">
                                <div class="col">
                                    <label for="">Width</label>
                                    <input class="text-input" type="number" name="IW" id="IW" value=""
                                        placeholder="Pixel size" required>
                                </div>
                                <div class="col">
                                    <label for="">Height</label>
                                    <input class="text-input" type="number" name="IH" id="IH" value=""
                                        placeholder="Pixel size" required>
                                </div>
                            </div>


                            {{!-- Name axis --}}
                            <h5>Name input Detials</h5>
                            <p style="color: red; font-size:12px;">Name input not added. Use all zero pixel</p>
                            <div class="axis-inputs">
                                <div class="col">
                                    <label for="">X axis</label>
                                    <input class="text-input" type="number" name="NX" id="NX" value="0"
                                        placeholder="Pixel size" required>
                                </div>
                                <div class="col">
                                    <label for="">Y axis</label>
                                    <input class="text-input" type="number" name="NY" id="NY" value="0"
                                        placeholder="Pixel size" required>
                                </div>
                            </div>
                            <div class="axis-inputs">
                                <div class="col">
                                    <label for="">Width</label>
                                    <input class="text-input" type="number" name="NW" id="NW" value="0"
                                        placeholder="Pixel size" required>
                                </div>
                                <div class="col">
                                    <label for="">Height</label>
                                    <input class="text-input" type="number" name="NH" id="NH" value="0"
                                        placeholder="Pixel size" required>
                                </div>
                            </div>

                        </div>
                </div>
                <div class="footer">
                    <button type="reset" class="btn-md cancel">Reset</button>
                    <button type="submit" class="btn-md save">Save</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

</section>


<script>

    function openmodelFrame(id) {
        let profileDiv = document.getElementById('profile-Div')
        let profile = document.getElementById('profile-model')
        let header = document.getElementById('model-header')
        let image = document.getElementById('profile-image')
        let image2 = document.getElementById('profile-image2')
        let HeaderInput = document.getElementById('header')
        let IXinput = document.getElementById('IX')
        let IYinput = document.getElementById('IY')
        let IWinput = document.getElementById('IW')
        let IHinput = document.getElementById('IH')
        let NXinput = document.getElementById('NX')
        let NYinput = document.getElementById('NY')
        let NWinput = document.getElementById('NW')
        let NHinput = document.getElementById('NH')
        let idInput = document.getElementById('slider-id')

        profileDiv.style.display = "flex"
        profile.style.display = "block"
        if (id == 'new') {
            header.innerHTML = "Create frame"
            idInput.value = ''
            HeaderInput.value = ''
            IXinput.value = ''
            IYinput.value = ''
            IWinput.value = ''
            IHinput.value = ''
            NXinput.value = '0'
            NYinput.value = '0'
            NWinput.value = '0'
            NHinput.value = '0'
            document.getElementById('frame-file1').value = ''
            document.getElementById('frame-file2').value = ''
            image.src = '/images/background/1.jpg'
            image2.src = '/images/background/1.jpg'
        } else {
            let Header = document.getElementById('header' + id).innerHTML
            let IX = document.getElementById('IX' + id).innerHTML
            let IY = document.getElementById('IY' + id).innerHTML
            let IW = document.getElementById('IW' + id).innerHTML
            let IH = document.getElementById('IH' + id).innerHTML
            let NX = document.getElementById('NX' + id).innerHTML
            let NY = document.getElementById('NY' + id).innerHTML
            let NW = document.getElementById('NW' + id).innerHTML
            let NH = document.getElementById('NH' + id).innerHTML

            header.innerHTML = "Update frame"
            image.src = '/images/frames/' + id + '-1.jpg'
            image2.src = '/images/frames/' + id + '-2.jpg'
            HeaderInput.value = Header
            IXinput.value = IX
            IYinput.value = IY
            IWinput.value = IW
            IHinput.value = IH
            NXinput.value = NX
            NYinput.value = NY
            NWinput.value = NW
            NHinput.value = NH
            idInput.value = id
        }
    }


    function deleteFrame(Id) {

        let div = document.getElementById('profileDiv' + Id)
        let Icon = document.getElementById('removeIcon' + Id)
        let confirmDiv = document.getElementById('confirm-box-div')
        let confirmTitle = document.getElementById('confirm-title')
        let yesButton = document.getElementById('confirmYes')
        let NoButton = document.getElementById('confirmNo')
        let title = "Do you want to delete this frame ?"

        Icon.className = 'bi bi-emoji-frown'
        confirmDiv.style.display = 'flex';
        confirmTitle.innerHTML = title

        yesButton.addEventListener("click", () => {
            $.ajax({
                url: '/admin/delete-frame',
                data: {
                    Id
                },
                method: 'post',
                success: (response) => {
                    div.style.display = 'none'
                    confirmDiv.style.display = 'none';

                }
            })
        });
        NoButton.addEventListener("click", () => {
            confirmDiv.style.display = 'none';
            Icon.className = 'i bi-trash3'
        });


    }


    function hideFrame(Id) {

        let div = document.getElementById('profileDiv' + Id)
        let Icon = document.getElementById('hideIcon' + Id)
        let Hide = document.getElementById('Hide' + Id)
        Icon.className = "bi bi-arrow-clockwise"
        $.ajax({
            url: '/admin/hide-frame',
            data: {
                Id,
                Hide: Hide.innerHTML

            },
            method: 'post',
            success: (response) => {
                if (response.Hide == "1") {
                    Icon.className = "bi bi-eye"
                    Icon.title = "Show to user"
                    Hide.innerHTML = "1"
                } else {
                    Icon.className = "bi bi-eye-slash"
                    Icon.title = "Hide form user"
                    Hide.innerHTML = " "
                }
            }

        });




    }

    function chooseImage1() {
        document.getElementById('frame-file1').click();
    }
    function chooseImage2() {
        document.getElementById('frame-file2').click();
    }


    function viewImage2(event) {
        var image = document.getElementById('profile-image2')
        var alertDiv = document.getElementById('alert-div')
        var alertContent = document.getElementById('alert-content')
        var alertAudio = document.getElementById('alert-audio')
        if (event.target.files && event.target.files[0]) {
            const file = event.target.files[0];
           
            const maxFileSize = 1048576; // 1 MB



            const img = new Image();
            img.src = URL.createObjectURL(file);
            img.onload = () => {

                if (file.size > maxFileSize) {
                    alert("Image file is too big. Please choose smaller than 1 MB")
                    alertContent.innerHTML = "Image file is too big. Please choose smaller than 1 MB"
                    alertDiv.style.display = "flex"
                    alertAudio.src = "/audio/alert/01.mp3"
                    setTimeout(hideAlert, 3000)
                } else {

                    image.src = URL.createObjectURL(event.target.files[0])



                }
            };
        }
    }



</script>

<script>
    function copyLinkFrame(Id) {
  
        /* Get the text field */
        let copyText = document.getElementById('copy-text' + Id);
        let copyDiv = document.getElementById('copy-btn-div' + Id);
        let copyIcon = document.getElementById('copy-btn-icon' + Id);
       

        /* Select the text field */
        copyText.select();
        copyText.setSelectionRange(0, 999999); /* For mobile devices */

        /* Copy the text inside the text field */
        navigator.clipboard.writeText(copyText.value);
        copyDiv.innerHTML = "Copied!"
        copyIcon.className = "bi bi-clipboard-check"
        
        const myTimeout = setTimeout(myGreeting, 5000);

        function myGreeting() {
            copyDiv.innerHTML = "Link"
            copyIcon.className = "bi bi-clipboard"
        
        }


    }
</script>